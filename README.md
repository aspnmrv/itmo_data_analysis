# itmo_data_analysis

# Анализ транзакций и выявление мошеннических операций

## Описание
Данное мини-исследование посвящено анализу анонимизированного набора транзакций клиентов.  


## Задание

Провести разведочный анализ данных, придумать продуктовые и технические гипотезы — какую ценность можете извлечь из данных для организации, которая предоставила данные.


## Данные
Использовались два датасета:
1. **transaction_fraud_data.parquet**  
   Содержит транзакции с признаками: категория вендора, тип устройства, страна, валюта, сумма, активность пользователя за последний час
2. **historical_currency_exchange.parquet**  
   Содержит исторические курсы валют к USD (для нормализации суммы транзакций)

---

## Основные шаги анализа

### 1. Предобработка
- Объединение транзакций с курсами валют по дате
- Перевод всех сумм в USD
- Разбор вложенного поля `last_hour_activity`
- Encoding категориальных признаков

### 2. EDA

В рамках EDA хотелось понять, какие данные есть, найти интересные зависимости, что поможет сформировать гипотезы, которые помогут извлечь пользу из предоставленных данных

- Проверка уникальности `transaction_id`
- Кол-во транзакций, уникальных пользователей
- Анализ сумм по категориям, странам, устройствам
- Сравнение легитимных и мошеннических транзакций
- Доля мошенничества по:
  - категориям и подкатегориям,
  - `is_outside_home_country`, `is_weekend`,
  - параметрам активности (`last_hour_activity`).
- Временные паттерны: пики фрода по часам и дням недели
- Визуализация распределений сумм (fraud vs non-fraud)

### 3. Гипотезы
- Мошенничество чаще встречается в:
  - транзакциях вне страны проживания,
  - высокорисковых категориях (развлечения, путешествия),
  - при аномальной активности за последний час
- Средняя сумма мошеннических транзакций выше, чем легитимных
- Устройства и каналы (mobile/web) влияют на вероятность фрода

### 4. Модели
- Logistic Regression (со стандартизацией признаков)
- Random Forest
- XGBoost
- CatBoost

Каждая модель была обучена с учётом дисбаланса классов

### 5. Метрики
Для оценки использовались:
- Accuracy
- Precision
- Recall
- F1-score
- ROC-AUC

Особое внимание уделялось **Recall** и **ROC-AUC**, так как в задаче фрод-детекции важно минимизировать пропуск мошеннических транзакций

---

## Результаты

- **Модели**:
  - Logistic Regression показала хороший Recall, но низкий Precision
  - Random Forest дал высокий Recall и приемлемый F1
  - XGBoost стал лучшей моделью по балансу Recall и Precision (высокий F1 и ROC-AUC)
  - CatBoost показал максимальный Precision, но более низкий Recall

- **Feature importance**:  
  Наиболее значимые признаки: `is_card_present`, `is_outside_home_country`, `is_high_risk_vendor`, параметры активности за последний час, сумма транзакции в USD

---

## Другие гипотезы
Помимо детекции мошеннических транзакций, предоставленные данные могут помочь в решении следующих задач, которые принесут пользу бизнесу:

- сегментация пользователей (кто-то предпочитает определенные категории, кто-то тратит больше или меньше). Это поможет персонализировать офферы для пользователей
- гео-аналитика: информация из предоставленных данных может быть полезна для гео-статистики, что может помочь для изучения новых рынков или оптимизировать затраты на маркетинг
- наличие данных об устройствах позволяет предположить, в какие из них имеет смысл вкладывать больше ресурсов в улучшение UI / ab testing и тд
- кредитный скоринг: также можем добавить признак (если имеется) о надежности клиента, а наши данные помогут добиться хорошей точности предсказаний
